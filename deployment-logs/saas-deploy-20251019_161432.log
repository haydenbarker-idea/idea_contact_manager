[2025-10-19 16:14:32] === Checking requirements ===
[0;32m‚úì Requirements met[0m
[2025-10-19 16:14:32] === STEP 1: Initial setup or update ===
[2025-10-19 16:14:32] SaaS instance exists - updating...
[2025-10-19 16:14:32] Fetching latest code...
[0;32m‚úì Code updated[0m
[2025-10-19 16:14:33] === SaaS Deployment Started ===
[2025-10-19 16:14:33] Timestamp: 20251019_161432
[2025-10-19 16:14:33] Branch: feature/viral-saas
[2025-10-19 16:14:33] Configuring git for automated log syncing...
[0;32m‚úì Git configured: hbarker@ideanetworks.com[0m
[2025-10-19 16:14:33] === STEP 2: Installing dependencies ===
[2025-10-19 16:14:33] Running npm install...

> contact-exchange@0.1.0 postinstall
> prisma generate

Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma

‚úî Generated Prisma Client (v5.22.0) to ./node_modules/@prisma/client in 134ms

Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)

Tip: Want to react to database changes in your app as they happen? Discover how with Pulse: https://pris.ly/tip-1-pulse


up to date, audited 517 packages in 6s

171 packages are looking for funding
  run `npm fund` for details

1 critical severity vulnerability

To address all issues, run:
  npm audit fix --force

Run `npm audit` for details.
[0;32m‚úì Dependencies installed[0m
[2025-10-19 16:14:39] === STEP 3: Configuring database ===
[0;32m‚úì Database contact_exchange_saas exists[0m
[2025-10-19 16:14:39] === STEP 4: Configuring environment ===
[2025-10-19 16:14:39] Backed up existing .env
[2025-10-19 16:14:39] Updating DATABASE_URL...
[2025-10-19 16:14:39] Updating NEXT_PUBLIC_APP_URL...
[0;32m‚úì Environment configured[0m
[2025-10-19 16:14:39] === STEP 5: Updating database schema ===
[2025-10-19 16:14:39] Pushing schema to database (creates/updates tables)...
Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma
Datasource "db": PostgreSQL database "contact_exchange_saas", schema "public" at "localhost:5432"

The database is already in sync with the Prisma schema.

[2025-10-19 16:14:41] Generating Prisma client...
Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma

‚úî Generated Prisma Client (v5.22.0) to ./node_modules/@prisma/client in 166ms

Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)

Tip: Want to turn off tips and other hints? https://pris.ly/tip-4-nohints

[0;32m‚úì Database schema updated[0m
[2025-10-19 16:14:44] Verifying database schema...
[0;32m‚úì ‚úì users table exists[0m
[0;32m‚úì ‚úì contacts table exists[0m
[2025-10-19 16:14:44] === STEP 6: Creating/updating systemd service ===
[2025-10-19 16:14:44] Creating service file...
[0;32m‚úì Service file created[0m
[2025-10-19 16:14:44] === STEP 7: Building application ===
[2025-10-19 16:14:44] Running npm run build (this takes ~90 seconds)...

> contact-exchange@0.1.0 build
> next build

 ‚ö† Invalid next.config.js options detected: 
 ‚ö†     Unrecognized key(s) in object: 'isrMemoryCacheSize' at "experimental"
 ‚ö† See more info here: https://nextjs.org/docs/messages/invalid-next-config
  ‚ñ≤ Next.js 14.2.14
  - Environments: .env

   Creating an optimized production build ...
 ‚úì Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/11) ...
   Generating static pages (2/11) 
Check slug error: B [Error]: Dynamic server usage: Route /api/users/check-slug couldn't be rendered statically because it used `request.url`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error
    at V (/var/www/contact-exchange-saas/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:21777)
    at Object.get (/var/www/contact-exchange-saas/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:29137)
    at c (/var/www/contact-exchange-saas/.next/server/app/api/users/check-slug/route.js:1:555)
    at /var/www/contact-exchange-saas/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:36963
    at /var/www/contact-exchange-saas/node_modules/next/dist/server/lib/trace/tracer.js:140:36
    at NoopContextManager.with (/var/www/contact-exchange-saas/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:7062)
    at ContextAPI.with (/var/www/contact-exchange-saas/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:518)
    at NoopTracer.startActiveSpan (/var/www/contact-exchange-saas/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:18093)
    at ProxyTracer.startActiveSpan (/var/www/contact-exchange-saas/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:18854)
    at /var/www/contact-exchange-saas/node_modules/next/dist/server/lib/trace/tracer.js:122:103 {
  description: "Route /api/users/check-slug couldn't be rendered statically because it used `request.url`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error",
  digest: 'DYNAMIC_SERVER_USAGE'
}
   Generating static pages (5/11) 
   Generating static pages (8/11) 
 ‚úì Generating static pages (11/11)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
‚îå ∆í /                                    142 B          87.3 kB
‚îú ‚óã /_not-found                          142 B          87.3 kB
‚îú ‚óã /admin                               31.9 kB         137 kB
‚îú ∆í /api/communications/email            0 B                0 B
‚îú ∆í /api/communications/sms              0 B                0 B
‚îú ∆í /api/contacts/[id]                   0 B                0 B
‚îú ∆í /api/contacts/[id]/communications    0 B                0 B
‚îú ∆í /api/contacts/[id]/status            0 B                0 B
‚îú ∆í /api/contacts/[id]/vcard             0 B                0 B
‚îú ∆í /api/contacts/list                   0 B                0 B
‚îú ∆í /api/contacts/submit                 0 B                0 B
‚îú ∆í /api/debug                           0 B                0 B
‚îú ∆í /api/templates                       0 B                0 B
‚îú ∆í /api/test/email                      0 B                0 B
‚îú ∆í /api/test/sms                        0 B                0 B
‚îú ∆í /api/upload/photo                    0 B                0 B
‚îú ∆í /api/uploads/[...path]               0 B                0 B
‚îú ∆í /api/users/check-slug                0 B                0 B
‚îú ∆í /api/users/signup                    0 B                0 B
‚îú ‚óã /api/vcard                           0 B                0 B
‚îú ‚óã /get-started                         4.36 kB         105 kB
‚îú ∆í /me                                  145 B           112 kB
‚îî ∆í /u/[username]                        145 B           112 kB
+ First Load JS shared by all            87.2 kB
  ‚îú chunks/117-ca9033809cf6eaa2.js       31.6 kB
  ‚îú chunks/fd9d1056-b88f8a4cc02eef8b.js  53.6 kB
  ‚îî other shared chunks (total)          1.96 kB


‚óã  (Static)   prerendered as static content
∆í  (Dynamic)  server-rendered on demand

[0;32m‚úì Build completed successfully[0m
[2025-10-19 16:16:03] === STEP 8: Setting up static files ===
[2025-10-19 16:16:03] === STEP 13: Syncing logs to GitHub ===
[2025-10-19 16:16:03] Adding deployment logs...
[2025-10-19 16:16:03] Committing logs...
[feature/viral-saas 9f3a6b2] logs: saas deployment 20251019_161432 - inactive unknown
 1 file changed, 146 insertions(+)
 create mode 100644 deployment-logs/saas-deploy-20251019_161432.log
[0;32m‚úì Logs committed locally[0m
[2025-10-19 16:16:03] Pushing to GitHub...
remote: Invalid username or token. Password authentication is not supported for Git operations.
fatal: Authentication failed for 'https://github.com/haydenbarker-idea/idea_contact_manager.git/'
[1;33m‚ö† ‚úó Could not push to GitHub[0m
[2025-10-19 16:21:44] Logs are committed locally but not pushed to GitHub
[2025-10-19 16:21:44] You may need to configure git credentials or use SSH keys
[0;31m‚úó === DEPLOYMENT FAILED ===[0m
[0;31m‚úó Exit code: 1[0m
[0;31m‚úó Failed at step: STEP 13: Syncing logs to GitHub[0m
[0;31m‚úó Check log file: /var/www/contact-exchange-saas/deployment-logs/saas-deploy-20251019_161432.log[0m


==================================================
  ‚ùå SaaS Deployment Failed
  Status: ‚ö†Ô∏è  FAILED
  Failed Step: STEP 13: Syncing logs to GitHub
==================================================

üìç Configuration:
   Directory: /var/www/contact-exchange-saas
   Database: contact_exchange_saas
   Service: contact-exchange-saas
   Port: 3001
   Branch: feature/viral-saas
   Log File: /var/www/contact-exchange-saas/deployment-logs/saas-deploy-20251019_161432.log
   Timestamp: 20251019_161432

üîß Troubleshooting:
   1. Review log: cat /var/www/contact-exchange-saas/deployment-logs/saas-deploy-20251019_161432.log
   2. Check service: sudo systemctl status contact-exchange-saas
   3. Check logs: journalctl -u contact-exchange-saas -n 100
   4. Pull logs locally: 
      cd ~/idea_contact_manager
      git checkout feature/viral-saas
      git pull origin feature/viral-saas
      # Review: deployment-logs/

üìù Logs synced to GitHub:
   Repository: https://github.com/haydenbarker-idea/idea_contact_manager
   Branch: feature/viral-saas
   Path: deployment-logs/
   Pull locally to review in Cursor!

==================================================

[2025-10-19 16:21:44] === DEPLOYMENT FAILED ===
[2025-10-19 16:21:44] Completed at: 2025-10-19 16:21:44
